"""
Last updated: 2023/11/28 xlsx file duplication
"""

import pandas as pd
import re

# Read the Excel file
file_path = "C:/Users/zhang/Desktop/FeaturePredict2/StrucMSFeature2.xlsx"
xl = pd.read_excel(file_path, sheet_name=None, engine="openpyxl")

# Initialize an empty list to store the data from "MS Feature" columns
ms_feature_data = []

# Iterate through all sheets and extract the columns containing "MS Feature"
for sheet_name, sheet_data in xl.items():
    for col_name in sheet_data.columns:
        if "MS Feature" in col_name:
            ms_feature_data.extend(sheet_data[col_name].dropna().tolist())

# Remove duplicates while preserving the order
seen = set()
ms_feature_data_no_duplicates = [x for x in ms_feature_data if not (x in seen or seen.add(x))]

# Assign the resulting list to the variable feature_formulas
feature_formulas = ms_feature_data_no_duplicates

# Initialize the lists for each category
C20 = []
C30 = []
C34 = []
C36 = []

# Classify the elements in feature_formulas
for formula in feature_formulas:
    carbon_count = int(re.search("C(\d+)", formula).group(1))

    if carbon_count <= 20:
        C20.append(formula)
    elif 20 < carbon_count <= 30:
        C30.append(formula)
    elif 30 < carbon_count <= 34:
        C34.append(formula)
    elif 34 < carbon_count <= 36:
        C36.append(formula)

C20_counts = len(C20)
C30_counts = len(C30)
C34_counts = len(C34)
C36_counts = len(C36)

# Print the results
print(C20_counts)  # 151
print(C30_counts)  # 266
print(C34_counts)  # 145
print(C36_counts)  # 132

print("C20: ", C20)
print("C30: ", C30)
print("C34: ", C34)
print("C36: ", C36)

"""
# Total cells: 21472
# Unique cells: 694
# Cells after removing duplicates (preserving one): 694

# Non-macrocyclic daphnane
# Total cells: 4048
# Unique cells: 151
# Cells after removing duplicates (preserving one): 151

# Macrocyclic daphnane
# Total cells: 17424
# Unique cells: 543
# Cells after removing duplicates (preserving one): 814

151
266
145
132
C20:  ['C20H24O4', 'C20H24O5', 'C20H24O6', 'C20H26O4', 'C20H26O5', 'C20H26O6', 'C20H28O4', 'C20H28O5', 'C20H28O6', 'C20H22O3', 'C20H22O4', 'C20H22O5', 'C20H24O3', 'C20H26O3', 'C19H24O3', 'C19H24O4', 'C19H24O5', 'C19H26O3', 'C19H26O4', 'C19H26O5', 'C19H28O3', 'C19H28O4', 'C19H28O5', 'C20H20O2', 'C20H20O3', 'C20H20O4', 'C20H22O2', 'C20H24O2', 'C19H22O2', 'C19H22O3', 'C19H22O4', 'C19H24O2', 'C19H26O2', 'C19H20O1', 'C19H20O2', 'C19H20O3', 'C19H22O1', 'C19H24O1', 'C17H20O2', 'C17H20O3', 'C17H20O4', 'C17H22O2', 'C17H22O3', 'C17H22O4', 'C17H24O2', 'C17H24O3', 'C17H24O4', 'C18H22O1', 'C18H22O2', 'C18H22O3', 'C18H24O1', 'C18H24O2', 'C18H24O3', 'C18H26O1', 'C18H26O2', 'C18H26O3', 'C17H18O1', 'C17H18O2', 'C17H18O3', 'C17H20O1', 'C17H22O1', 'C15H18O2', 'C15H18O3', 'C15H18O4', 'C15H20O2', 'C15H20O3', 'C15H20O4', 'C15H22O2', 'C15H22O3', 'C15H22O4', 'C20H24O7', 'C20H26O7', 'C20H28O7', 'C20H24O8', 'C20H26O8', 'C20H28O8', 'C20H22O6', 'C20H22O7', 'C20H20O5', 'C20H20O6', 'C20H18O3', 'C20H18O4', 'C20H18O5', 'C20H18O2', 'C19H20O4', 'C19H20O5', 'C19H22O5', 'C20H16O2', 'C20H16O3', 'C20H16O4', 'C20H16O1', 'C20H18O1', 'C20H20O1', 'C19H18O2', 'C19H18O3', 'C19H18O4', 'C19H18O1', 'C19H16O2', 'C19H16O3', 'C19H16O4', 'C19H16O1', 'C19H16', 'C19H18', 'C19H20', 'C17H16O2', 'C17H16O3', 'C17H16O4', 'C17H18O4', 'C17H16O1', 'C20H28O3', 'C20H26O2', 'C20H22O1', 'C20H24O1', 'C19H26O1', 'C20H18', 'C20H20', 'C20H22', 'C18H18O2', 'C18H20O2', 'C18H18O3', 'C18H20O3', 'C18H18O4', 'C18H20O4', 'C18H22O4', 'C18H18O1', 'C18H20O1', 'C19H22', 'C19H24', 'C17H14O2', 'C17H14O3', 'C17H14O4', 'C17H14O1', 'C19H20O6', 'C19H22O6', 'C19H24O6', 'C19H18O5', 'C20H24O9', 'C20H26O9', 'C20H22O8', 'C20H20O7', 'C20H18O6', 'C20H16O5', 'C19H16O5', 'C17H16O5', 'C17H18O5', 'C18H18O5', 'C18H20O5', 'C17H14O5', 'C19H20O7', 'C19H22O7', 'C19H18O6']
C30:  ['C29H42O8', 'C29H44O8', 'C29H42O9', 'C29H44O9', 'C30H44O8', 'C30H46O8', 'C30H44O9', 'C30H46O9', 'C30H44O10', 'C30H46O10', 'C30H44O11', 'C30H46O11', 'C30H44O12', 'C30H46O12', 'C30H48O12', 'C30H46O13', 'C30H48O13', 'C29H42O10', 'C29H44O10', 'C30H44O13', 'C30H46O14', 'C30H48O14', 'C29H42O11', 'C29H44O11', 'C30H44O14', 'C30H46O15', 'C30H48O15', 'C29H40O7', 'C29H42O7', 'C29H40O8', 'C30H42O7', 'C30H44O7', 'C30H42O8', 'C30H42O9', 'C30H42O10', 'C30H42O11', 'C29H40O9', 'C30H42O12', 'C29H40O10', 'C30H42O13', 'C29H38O6', 'C29H40O6', 'C29H38O7', 'C30H40O6', 'C30H42O6', 'C30H40O7', 'C30H40O8', 'C30H40O9', 'C30H40O10', 'C29H38O8', 'C30H40O11', 'C29H38O9', 'C30H40O12', 'C29H36O5', 'C29H38O5', 'C29H36O6', 'C30H38O5', 'C30H40O5', 'C30H38O6', 'C30H38O7', 'C30H38O8', 'C30H38O9', 'C29H36O7', 'C30H38O10', 'C29H36O8', 'C30H38O11', 'C29H34O4', 'C29H36O4', 'C29H34O5', 'C30H36O4', 'C30H38O4', 'C30H36O5', 'C30H36O6', 'C30H36O7', 'C30H36O8', 'C29H34O6', 'C30H36O9', 'C29H34O7', 'C30H36O10', 'C28H36O4', 'C28H38O4', 'C28H36O5', 'C28H38O5', 'C29H38O4', 'C29H40O4', 'C29H40O5', 'C28H36O6', 'C28H38O6', 'C28H36O7', 'C28H38O7', 'C29H38O10', 'C29H40O11', 'C28H34O4', 'C28H34O5', 'C28H34O6', 'C29H36O9', 'C28H34O7', 'C29H36O10', 'C29H38O11', 'C29H32O3', 'C29H34O3', 'C29H32O4', 'C30H34O3', 'C30H36O3', 'C30H34O4', 'C30H34O5', 'C30H34O6', 'C30H34O7', 'C29H32O5', 'C30H34O8', 'C29H32O6', 'C30H34O9', 'C28H34O3', 'C28H36O3', 'C29H36O3', 'C29H38O3', 'C28H32O2', 'C28H34O2', 'C28H32O3', 'C29H34O2', 'C29H36O2', 'C28H32O4', 'C28H32O5', 'C29H34O8', 'C27H32O2', 'C27H34O2', 'C27H32O3', 'C27H34O3', 'C28H36O2', 'C27H32O4', 'C27H34O4', 'C28H36O8', 'C28H38O8', 'C27H32O5', 'C27H34O5', 'C28H34O8', 'C28H36O9', 'C28H38O9', 'C29H44O7', 'C30H46O7', 'C30H48O11', 'C29H46O9', 'C29H46O10', 'C30H48O9', 'C30H48O10', 'C30H50O13', 'C30H50O14', 'C29H46O11', 'C30H50O15', 'C29H44O12', 'C29H46O12', 'C30H48O16', 'C30H50O16', 'C29H46O8', 'C30H48O8', 'C30H50O12', 'C29H44O6', 'C29H46O6', 'C29H46O7', 'C30H46O6', 'C30H48O6', 'C30H48O7', 'C30H50O10', 'C30H50O11', 'C30H42O14', 'C30H44O15', 'C29H42O12', 'C30H46O16', 'C29H42O6', 'C30H44O6', 'C29H42O5', 'C29H44O5', 'C30H44O5', 'C30H46O5', 'C30H40O13', 'C30H42O5', 'C29H42O4', 'C30H42O4', 'C30H44O4', 'C30H38O12', 'C30H40O4', 'C29H40O3', 'C30H40O3', 'C30H42O3', 'C30H36O11', 'C30H38O3', 'C29H38O2', 'C30H38O2', 'C30H40O2', 'C29H32O7', 'C30H34O10', 'C28H38O3', 'C28H40O5', 'C28H40O6', 'C28H40O7', 'C28H40O8', 'C28H40O4', 'C28H38O2', 'C28H40O2', 'C28H40O3', 'C29H40O2', 'C29H42O2', 'C29H42O3', 'C29H40O12', 'C28H32O6', 'C29H34O9', 'C28H32O7', 'C29H34O10', 'C29H36O11', 'C29H38O12', 'C29H32O2', 'C30H34O2', 'C30H36O2', 'C29H34O1', 'C29H36O1', 'C30H36O1', 'C30H38O1', 'C29H30O4', 'C30H32O4', 'C30H32O5', 'C30H32O6', 'C30H32O7', 'C29H30O5', 'C30H32O8', 'C29H30O6', 'C30H32O9', 'C29H30O3', 'C30H32O3', 'C28H36O1', 'C28H38O1', 'C29H38O1', 'C29H40O1', 'C28H32O1', 'C28H34O1', 'C28H34', 'C28H36', 'C29H36', 'C29H38', 'C28H30O3', 'C28H30O4', 'C28H30O5', 'C29H32O8', 'C28H30O2', 'C27H32O1', 'C27H34O1', 'C27H36O3', 'C27H36O4', 'C27H36O5', 'C28H40O9', 'C27H34O6', 'C27H36O6', 'C28H38O10', 'C28H40O10', 'C27H36O2', 'C27H34', 'C27H36', 'C27H36O1', 'C28H38', 'C27H30O3', 'C27H30O4', 'C27H30O5', 'C28H32O8', 'C28H34O9', 'C27H30O2', 'C27H32O6', 'C28H36O10']
C34:  ['C34H50O8', 'C34H52O8', 'C34H50O9', 'C34H52O9', 'C34H50O10', 'C34H52O10', 'C34H50O11', 'C34H52O11', 'C34H48O7', 'C34H50O7', 'C34H48O8', 'C34H48O9', 'C34H48O10', 'C34H46O6', 'C34H48O6', 'C34H46O7', 'C34H46O8', 'C34H46O9', 'C34H44O5', 'C34H46O5', 'C34H44O6', 'C34H44O7', 'C34H44O8', 'C34H42O4', 'C34H44O4', 'C34H42O5', 'C34H42O6', 'C34H42O7', 'C33H44O4', 'C33H46O4', 'C33H44O5', 'C33H46O5', 'C33H44O6', 'C33H46O6', 'C33H44O7', 'C33H46O7', 'C33H42O4', 'C33H42O5', 'C33H42O6', 'C33H42O7', 'C34H40O3', 'C34H42O3', 'C34H40O4', 'C34H40O5', 'C34H40O6', 'C33H42O3', 'C33H44O3', 'C33H40O2', 'C33H42O2', 'C33H40O3', 'C33H40O4', 'C33H40O5', 'C32H40O2', 'C32H42O2', 'C32H40O3', 'C32H42O3', 'C34H44O2', 'C34H46O2', 'C34H44O3', 'C34H46O3', 'C34H48O3', 'C34H46O4', 'C34H48O4', 'C32H40O4', 'C32H42O4', 'C34H48O5', 'C32H40O5', 'C32H42O5', 'C34H52O7', 'C34H54O9', 'C34H54O10', 'C34H54O11', 'C34H52O12', 'C34H54O12', 'C34H54O8', 'C34H52O6', 'C34H54O6', 'C34H54O7', 'C34H48O11', 'C34H50O12', 'C34H50O6', 'C34H50O5', 'C34H52O5', 'C34H46O10', 'C34H50O4', 'C34H44O9', 'C34H42O8', 'C34H40O7', 'C33H46O3', 'C33H48O5', 'C33H48O6', 'C33H48O7', 'C33H46O8', 'C33H48O8', 'C33H48O4', 'C33H46O2', 'C33H48O2', 'C33H48O3', 'C33H44O8', 'C33H44O2', 'C33H40O6', 'C33H40O7', 'C33H42O8', 'C34H40O2', 'C34H42O2', 'C34H42O1', 'C34H44O1', 'C34H38O4', 'C34H38O5', 'C34H38O6', 'C34H38O3', 'C33H44O1', 'C33H46O1', 'C33H40O1', 'C33H42O1', 'C33H42', 'C33H44', 'C33H38O3', 'C33H38O4', 'C33H38O5', 'C33H38O2', 'C32H40O1', 'C32H42O1', 'C34H46O1', 'C34H48O2', 'C32H44O3', 'C32H44O4', 'C32H44O5', 'C32H42O6', 'C32H44O6', 'C32H44O2', 'C34H50O3', 'C32H42', 'C32H44', 'C32H44O1', 'C34H46', 'C34H48', 'C34H48O1', 'C34H50O1', 'C34H50O2', 'C32H38O3', 'C32H38O4', 'C32H38O5', 'C32H38O2', 'C32H40O6']
C36:  ['C36H54O8', 'C36H56O8', 'C36H54O9', 'C36H56O9', 'C36H58O9', 'C36H56O10', 'C36H58O10', 'C36H54O10', 'C36H56O11', 'C36H58O11', 'C36H54O11', 'C36H56O12', 'C36H58O12', 'C36H52O7', 'C36H54O7', 'C36H52O8', 'C36H52O9', 'C36H52O10', 'C36H50O6', 'C36H52O6', 'C36H50O7', 'C36H50O8', 'C36H50O9', 'C36H48O5', 'C36H50O5', 'C36H48O6', 'C36H48O7', 'C36H48O8', 'C36H46O4', 'C36H48O4', 'C36H46O5', 'C36H46O6', 'C36H46O7', 'C35H48O4', 'C35H50O4', 'C35H48O5', 'C35H50O5', 'C35H52O5', 'C35H50O6', 'C35H52O6', 'C35H48O6', 'C35H50O7', 'C35H52O7', 'C35H48O7', 'C35H50O8', 'C35H52O8', 'C35H46O4', 'C35H46O5', 'C35H46O6', 'C35H46O7', 'C35H48O8', 'C36H44O3', 'C36H46O3', 'C36H44O4', 'C36H44O5', 'C36H44O6', 'C35H46O3', 'C35H48O3', 'C35H44O2', 'C35H46O2', 'C35H44O3', 'C35H44O4', 'C35H44O5', 'C36H56O7', 'C36H58O8', 'C36H60O10', 'C36H60O11', 'C36H60O12', 'C36H58O13', 'C36H60O13', 'C36H60O9', 'C36H56O6', 'C36H58O6', 'C36H58O7', 'C36H60O7', 'C36H60O8', 'C36H52O11', 'C36H54O12', 'C36H56O13', 'C36H54O6', 'C36H54O5', 'C36H56O5', 'C36H50O10', 'C36H52O5', 'C36H52O4', 'C36H54O4', 'C36H48O9', 'C36H50O4', 'C36H50O3', 'C36H52O3', 'C36H46O8', 'C36H48O3', 'C36H48O2', 'C36H50O2', 'C36H44O7', 'C35H50O3', 'C35H52O4', 'C35H54O6', 'C35H54O7', 'C35H54O8', 'C35H52O9', 'C35H54O9', 'C35H54O5', 'C35H50O2', 'C35H52O2', 'C35H52O3', 'C35H54O3', 'C35H54O4', 'C35H50O9', 'C35H48O2', 'C35H44O6', 'C35H44O7', 'C35H46O8', 'C35H48O9', 'C36H44O2', 'C36H46O2', 'C36H46O1', 'C36H48O1', 'C36H42O4', 'C36H42O5', 'C36H42O6', 'C36H42O3', 'C35H48O1', 'C35H50O1', 'C35H44O1', 'C35H46O1', 'C35H46', 'C35H48', 'C35H42O3', 'C35H42O4', 'C35H42O5', 'C35H42O2']
"""
